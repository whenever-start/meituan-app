(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-731a4d73"],{"0a49":function(t,o,e){var n=e("9b43"),s=e("626a"),i=e("4bf8"),r=e("9def"),a=e("cd1c");t.exports=function(t,o){var e=1==t,c=2==t,u=3==t,l=4==t,d=6==t,h=5==t||d,f=o||a;return function(o,a,g){for(var p,m,v=i(o),w=s(v),P=n(a,g,3),b=r(w.length),C=0,_=e?f(o,b):c?f(o,0):void 0;b>C;C++)if((h||C in w)&&(p=w[C],m=P(p,C,v),t))if(e)_[C]=m;else if(m)switch(t){case 3:return!0;case 5:return p;case 6:return C;case 2:_.push(p)}else if(l)return!1;return d?-1:u||l?l:_}}},1169:function(t,o,e){var n=e("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"6bf7":function(t,o,e){},7514:function(t,o,e){"use strict";var n=e("5ca1"),s=e("0a49")(5),i="find",r=!0;i in[]&&Array(1)[i](function(){r=!1}),n(n.P+n.F*r,"Array",{find:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),e("9c6c")(i)},"9d50":function(t,o,e){"use strict";var n=e("6bf7"),s=e.n(n);s.a},cd1c:function(t,o,e){var n=e("e853");t.exports=function(t,o){return new(n(t))(o)}},e853:function(t,o,e){var n=e("d3f4"),s=e("1169"),i=e("2b4c")("species");t.exports=function(t){var o;return s(t)&&(o=t.constructor,"function"!=typeof o||o!==Array&&!s(o.prototype)||(o=void 0),n(o)&&(o=o[i],null===o&&(o=void 0))),void 0===o?Array:o}},f1cd:function(t,o,e){"use strict";e.r(o);var n=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"login"},[e("header",{staticClass:"login-header"},[e("div",{staticClass:"login-close iconfont icon-LC_icon_close_fill_circle",on:{click:function(o){return t.$router.go(-1)}}}),e("router-link",{attrs:{to:"/help"}},[t._v("帮助")])],1),e("div",{staticClass:"login-form"},[e("p",{staticClass:"login-form-title"},[t._v("欢迎登陆美团")]),e("form",{staticClass:"login-form-main",attrs:{action:"post"}},[e("div",{staticClass:"form-item"},[t._m(0),e("el-input",{staticClass:"form-input",attrs:{placeholder:"请输入手机号",clearable:"",maxlength:t.phoneLength},model:{value:t.userPhone,callback:function(o){t.userPhone=o},expression:"userPhone"}})],1),t.isLoginWithPassword?e("div",{staticClass:"form-item"},[e("el-input",{attrs:{clear:"form-input",placeholder:"请输入密码","show-password":"",clearable:"",maxlength:t.passwordMaxLength},on:{change:t.passwordChange},model:{value:t.password,callback:function(o){t.password=o},expression:"password"}})],1):t._e(),e("p",{staticClass:"login-form-main-tips"},[t._v("未注册的手机号验证后自动创建账户")]),t.isLoginWithPassword?e("button",{staticClass:"rounded-long-primary-btn",attrs:{id:"login-form-get_authentication",type:"button",disabled:!t.isPhoneFormatValid},on:{click:t.loginWithPassword}},[t._v("\n                登录\n            ")]):e("button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"rounded-long-primary-btn",attrs:{id:"login-form-get_authentication",type:"button",disabled:!t.isPhoneFormatValid},on:{click:t.loginWithAuthcode}},[t._v("\n                获取短信验证码\n            ")])]),e("div",{staticClass:"login-form-by-password",on:{click:t.tabLoginMethod}},[t._v("\n            "+t._s(t._f("loginMethod")(t.isLoginWithPassword))+"\n        ")])]),e("footer",{staticClass:"login-footer"},[t._m(1),e("p",{staticClass:"login-footer-p"},[t._v("\n            登陆代表你已同意\n            "),e("router-link",{staticClass:"login-footer-p-mark",attrs:{to:"/user-protocol"}},[t._v("用户协议")]),t._v("\n            、\n            "),e("router-link",{staticClass:"login-footer-p-mark",attrs:{to:"/privacy-policy"}},[t._v("隐私政策")])],1)])])},s=[function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"form-input_append"},[t._v("+86 "),e("i",{staticClass:"iconfont icon-next-m"})])},function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"login-footer-other_ways"},[e("div",{staticClass:"icon-wrapper"},[e("i",{staticClass:"iconfont icon-wechat"})]),e("div",{staticClass:"icon-wrapper"},[e("i",{staticClass:"iconfont icon-qq"})])])}],i=(e("7514"),e("cebc")),r=e("7f43"),a=e.n(r),c=e("f70b"),u=e("2f62"),l={name:"Login",mixins:[c["a"]],data:function(){return{isLoginWithPassword:!1,redirect:"",authCode:"",loading:!1,phoneLength:11,passwordMaxLength:18}},computed:Object(i["a"])({},Object(u["e"])("login",{}),{userPhone:{get:function(){return this.$store.state.login.userPhone},set:function(t){this.$store.commit("login/setUserPhone",t)}},password:{get:function(){return this.$store.state.login.password},set:function(t){this.$store.commit("login/setPassword",t)}},isPasswordFormatValid:function(){var t=/^[a-zA-Z]\w{5,17}$/;return t.test(this.password)},isPhoneFormatValid:function(){var t=/^([1][3,4,5,6,7,8,9])\d{9}$/;return t.test(this.userPhone)}}),methods:Object(i["a"])({},Object(u["d"])("login",["setUserPhone","setPassword","setAuthcode"]),{tabLoginMethod:function(){this.isLoginWithPassword=!this.isLoginWithPassword},passwordChange:function(t){this.isPasswordFormatValid||this.$message.error("请重新设置密码,以字母开头，长度在6~18之间，只能包含字母、数字和下划线")},loginWithPassword:function(){var t=this;if(!this.isPasswordFormatValid)return this.$message.error("密码格式错误"),void this.setPassword("");a.a.post("/api/login-password",{userPhone:this.userPhone,password:this.password}).then(function(o){var e=JSON.parse(o.data).code;switch(e){case 0:case 1:console.log("login-userPhone:",t.userPhone),t.$cookie.set("userPhone",t.userPhone,3),t.$router.push(t.redirect);break;case 2:t.$message.error("密码不正确"),t.setPassword("");break;case 3:t.$message.error("用户不存在"),t.setPassword("");break;default:t.$router.push("/home")}}).catch(function(t){return console.log(t)})},loginWithAuthcode:function(){var t=this;this.loading=!0,this.requestAuthcode(function(o){t.authCode=o.data.authCode,t.saveAuthInfo(t),t.$router.push("/login/inputAuthcode")},{},function(){return t.loading=!1})}}),filters:{loginMethod:function(t){return t?"验证码登录":"密码登录"}},beforeRouteEnter:function(t,o,e){e(function(t){var e=["/order","/mine"],n=e.find(function(t){return o.fullPath===t});n&&(t.redirect=n)})},created:function(){console.log("login-userPhone:",this.userPhone)}},d=l,h=(e("9d50"),e("2877")),f=Object(h["a"])(d,n,s,!1,null,null,null);o["default"]=f.exports},f70b:function(t,o,e){"use strict";var n=e("7f43"),s=e.n(n),i={methods:{saveAuthInfo:function(t){var o={startTime:(new Date).getTime(),authCode:t.authCode,redirect:t.redirect};sessionStorage.setItem("authInfo",JSON.stringify(o))},requestAuthcode:function(t,o,e){s.a.get("/api/create-authcode").then(function(o){o.data.authcodeReady&&t&&t(o)}).catch(function(t){o&&o(),console.log(t)}).finally(function(){return e&&e()})},fetchSesstionStorage:function(t){return JSON.parse(sessionStorage.getItem(t))}}};o["a"]=i}}]);
//# sourceMappingURL=chunk-731a4d73.7fe2e6b0.js.map